---
layout: post
title:  "Django_기본.외래키"
comments: true
description: "Django"
author: SeungHyeon Tak
date:   2019-06-09 22:10:27 +0700
categories: [Django]
tags: [Django]
keywords: "Django"
---
#### Django.기본 웹 개발

#### 외래키
<br>
#### Foreignkey 1:N 관계
  * 1과 N중 N 쪽에 ForrignKey 설정해줌
post = models.ForeignKey()를 만들면 DB테이블에
post_id로 생성이된다.
<br>
#### ManyToMany M:N 관계
  * models.ManyToMany('Tag') - 문자열로 지정해줄 수 있음
현재 Post Tag 가있지만 어느 필드던 둘 수 있다.
하지만 Tag쪽에서 빠듯하게 쓸필요는 없는듯하여 상황에 맞게 쓰자
<br>
#### OneToOne 1:1관계
  * django.contrib.auth.models.User모델을 기본 제공
User에 대한 부가적인 정보 (전화번호, 주소 등)을 저장하기 위해 Profile모델을 1:1관계로 설계 가능

```python
# 비추
from django.contrib.auth.models import User
OneToOneField(User)

# 추천
from django.conf import settings
user = models.OneToOneField(settings.AUTH_USER_MODEL, on_delete=model.CASCADE)
# 이렇게 쓰는것이 나중에 충돌안나고 좋다
```

#### ForeignKey와 OneToOne의 차이
* 유일성의 차이
  * OneToOne은 하나대 하나

```
-> from django.conf import settins
settings.AUTH_USER_MODEL 로 쓴다. 이걸 가장 추천
```

<br>
#### ForeignKey.on_delete 옵션
* CASCADE : 연결된 Row를 일괄 삭제 (디폴트 동작)
* PROTECT : ProtectedError 예외를 발생시키며 삭제 방지

#### related_name 지정의 필요성
다른 앱을 생성해서 똑같은 name에 ForeignKey를 생성해줘서 그럼
blog/shop - shop/blog 들이 user라는 ForeignKey를 가지고 있기 때문에
둘다 가지려 하기 때문에 충돌남 makemigrations 할때 Error 발생
그래서 reated_name = 'blog_post_set' 이렇게 정의함
